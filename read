#!/bin/sh

process () {
  echo $1
}

getImageDimensions() {
  echo $(identify -verbose "$background" | \
    sed -En 's/^  Geometry: ([0-9]+)x([0-9]+)\+0\+0$/\1 \2/p')
}

if [ -f background.png ];
then
  background=background.png
fi

if [ -z "$background" ];
then
  echo "error" 1>&2
  exit 1
fi

read backgroundWidth backgroundHeight <<<$(getImageDimensions "$background")
echo $backgroundWidth
echo $backgroundHeight

find in -mindepth 1 | while read file; do process "$file"; done

echo $RAMDOM
